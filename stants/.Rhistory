fit_stan <- function(y, x, model_name = NA, est_drift = FALSE, n_mcmc = 1000, n_burn = 500, n_chain = 3, n_thin = 1) {
if(model_name == "regression") {
if(class(x)!="matrix") x = matrix(x,ncol=1)
mod = stan("exec/regression.stan", data = list("x"=x,"y"=y,"N"=length(y),"K"=dim(x)[2]),
pars = c("beta","sigma","pred"), chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift = FALSE) {
mod = stan("exec/rw.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift = TRUE) {
mod = stan("exec/rw_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift = FALSE) {
mod = stan("exec/ar1.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift = TRUE) {
mod = stan("exec/ar1_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar2" & est_drift = FALSE) {
mod = stan("exec/ar2.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
return(mod)
}
if(model_name == "regression") {
if(class(x)!="matrix") x = matrix(x,ncol=1)
mod = stan("exec/regression.stan", data = list("x"=x,"y"=y,"N"=length(y),"K"=dim(x)[2]),
pars = c("beta","sigma","pred"), chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == FALSE) {
mod = stan("exec/rw.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == TRUE) {
mod = stan("exec/rw_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == FALSE) {
mod = stan("exec/ar1.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == TRUE) {
mod = stan("exec/ar1_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar2" & est_drift == FALSE) {
mod = stan("exec/ar2.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
return(mod)
fit_stan <- function(y, x, model_name = NA, est_drift = FALSE, n_mcmc = 1000, n_burn = 500, n_chain = 3, n_thin = 1) {
if(model_name == "regression") {
if(class(x)!="matrix") x = matrix(x,ncol=1)
mod = stan("exec/regression.stan", data = list("x"=x,"y"=y,"N"=length(y),"K"=dim(x)[2]),
pars = c("beta","sigma","pred"), chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == FALSE) {
mod = stan("exec/rw.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == TRUE) {
mod = stan("exec/rw_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == FALSE) {
mod = stan("exec/ar1.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == TRUE) {
mod = stan("exec/ar1_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar2" & est_drift == FALSE) {
mod = stan("exec/ar2.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
return(mod)
}
fit_stan <- function(y, x, model_name = NA, est_drift = FALSE, n_mcmc = 1000, n_burn = 500, n_chain = 3, n_thin = 1) {
if(model_name == "regression") {
if(class(x)!="matrix") x = matrix(x,ncol=1)
mod = stan("exec/regression.stan", data = list("x"=x,"y"=y,"N"=length(y),"K"=dim(x)[2]),
pars = c("beta","sigma","pred"), chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == FALSE) {
mod = stan("exec/rw.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == TRUE) {
mod = stan("exec/rw_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == FALSE) {
mod = stan("exec/ar1.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == TRUE) {
mod = stan("exec/ar1_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar2" & est_drift == FALSE) {
mod = stan("exec/ar2.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
return(mod)
}
fit_stan(y = y, x = x, model_name="ar2")
library(rstan)
fit_stan(y = y, x = x, model_name="ar2")
y
data("airquality")
y = airquality$Temp
x = airquality$Month
fit_stan(y = y, x = x, model_name="ar2")
fit_stan <- function(y, x, model_name = NA, est_drift = FALSE, P = 1, n_mcmc = 1000, n_burn = 500, n_chain = 3, n_thin = 1) {
if(model_name == "regression") {
if(class(x)!="matrix") x = matrix(x,ncol=1)
mod = stan("exec/regression.stan", data = list("x"=x,"y"=y,"N"=length(y),"K"=dim(x)[2]),
pars = c("beta","sigma","pred"), chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == FALSE) {
mod = stan("exec/rw.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "rw" & est_drift == TRUE) {
mod = stan("exec/rw_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar1" & est_drift == FALSE) {
mod = stan("exec/ar1.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar" & est_drift == TRUE) {
mod = stan("exec/ar_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
if(model_name == "ar2" & est_drift == FALSE) {
mod = stan("exec/ar2.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = n_chain, iter = n_mcmc, thin = n_thin)
}
return(mod)
}
fit_stan(y = y, x = x, model_name="ar", est_drift=TRUE)
library(stants)
?stan_model
stan_model("exec/ma1.stan", save_dso=TRUE)
stan_model("exec/ar_drift.stan", save_dso=TRUE)
stan_model("exec/ar_drift.stan", save_dso=TRUE, auto_write=TRUE)
?source
library(stants)
class(mod)
fit_stan <- function(y, x, model_name = NA, est_drift = FALSE, P = 1, mcmc_list = list(n_mcmc = 1000, n_burn = 500, n_chain = 3, n_thin = 1)) {
if(model_name == "regression") {
if(class(x)!="matrix") x = matrix(x,ncol=1)
mod = stan("exec/regression.stan", data = list("x"=x,"y"=y,"N"=length(y),"K"=dim(x)[2]),
pars = c("beta","sigma","pred"), chains = mcmc_list$n_chain, iter = mcmc_list$n_mcmc, thin = mcmc_list$n_thin)
}
if(model_name == "rw" & est_drift == FALSE) {
mod = stan("exec/rw.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred"),
chains = mcmc_list$n_chain, iter = mcmc_list$n_mcmc, thin = mcmc_list$n_thin)
}
if(model_name == "rw" & est_drift == TRUE) {
mod = stan("exec/rw_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu"),
chains = mcmc_list$n_chain, iter = mcmc_list$n_mcmc, thin = mcmc_list$n_thin)
}
if(model_name == "ar" & est_drift == FALSE) {
mod = stan("exec/ar.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","phi"),
chains = mcmc_list$n_chain, iter = mcmc_list$n_mcmc, thin = mcmc_list$n_thin)
}
if(model_name == "ar" & est_drift == TRUE) {
mod = stan("exec/ar_drift.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = mcmc_list$n_chain, iter = mcmc_list$n_mcmc, thin = mcmc_list$n_thin)
}
if(model_name == "ma1") {
mod = stan("exec/ma1.stan", data = list("y"=y,"N"=length(y)), pars = c("sigma","pred","mu","phi"),
chains = mcmc_list$n_chain, iter = mcmc_list$n_mcmc, thin = mcmc_list$n_thin)
}
return(mod)
}
y
x
mod = fit_stan(y, x)
mod = fit_stan(y, x, model_name = "regression")
class(mod)
library(stants)
